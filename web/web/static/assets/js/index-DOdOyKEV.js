import{_ as it,u as rt,B as xt,a as g,r as dt,c as At,w as j,b as ft,o as ut,t as gt,d as _t,e as f,C as pt,h as U,D as W,i as s,j as v,q as Y,f as u,A as k,F as S,k as Q,v as q,y as P,n as N,g as vt,T as mt,p as wt,m as ht}from"./index-0Bx8Cp--.js";import{b as kt,n as Bt,_ as yt}from"./up-mnMb4hQa.js";const st=function(){let e=!0;return function(i,o){const n=e?function(){if(o){const x=o.apply(i,arguments);return o=null,x}}:function(){};return e=!1,n}}(),L=st(void 0,function(){return L.toString().search("(((.+)+)+)+$").toString().constructor(L).search("(((.+)+)+)+$")});L();const at=function(){let e=!0;return function(i,o){const n=e?function(){if(o){const x=o.apply(i,arguments);return o=null,x}}:function(){};return e=!1,n}}();(function(){at(this,function(){const e=new RegExp("function *\\( *\\)"),i=new RegExp("\\+\\+ *(?:[a-zA-Z_$][0-9a-zA-Z_$]*)","i"),o=M("init");!e.test(o+"chain")||!i.test(o+"input")?o("0"):M()})()})();const y=function(){let e=!0;return function(i,o){const n=e?function(){if(o){const x=o.apply(i,arguments);return o=null,x}}:function(){};return e=!1,n}}(),lt=y(void 0,function(){let e;try{e=Function('return (function() {}.constructor("return this")( ));')()}catch{e=window}const i=e.console=e.console||{},o=["log","warn","info","error","exception","table","trace"];for(let n=0;n<o.length;n++){const x=y.constructor.prototype.bind(y),_=o[n],d=i[_]||x;x.__proto__=y.bind(y),x.toString=d.toString.bind(d),i[_]=x}});lt();const Ct="data:image/png;base64,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";(function(){(function(){let o;try{o=Function('return (function() {}.constructor("return this")( ));')()}catch{o=window}return o})().setInterval(M,2e3)})();const It={name:"ArticleDetail",setup(){const e=rt(),i=xt(),o=g(1234),n=g(88),x=g(!1),_=g(!1),d=dt({articleData:{},relatedArticles:[],keyWordsMap:{}}),r=g(null),p=g([]),m=g(""),E=g(!1),O=g(!1);let w=null,C=null;const b=new Set,Z=At(()=>d.articleData.keyWords?d.articleData.keyWords.split(",").filter(t=>t).map(t=>d.keyWordsMap[t]||t):[]);function z(t,a){let c=null,l=0;return function(...A){const h=Date.now();h-l>=a?(t.apply(this,A),l=h):c||(c=setTimeout(()=>{t.apply(this,A),l=h,c=null},a))}}const F=(t,a)=>{let c=null;return function(...l){c&&clearTimeout(c),c=setTimeout(()=>{t.apply(this,l),c=null},a)}},G=()=>{x.value||(n.value++,x.value=!0)},V=()=>{e.back()},T=t=>{_.value=!0,kt({id:t}).then(a=>{d.articleData=a.data,a.data.keyWords&&X(a.data.keyWords)}).finally(()=>{_.value=!1})},X=t=>{const c={pageNo:1,pageSize:3,keyWords:t.split(",")[0],status:1,recommended:1};Bt(c).then(l=>{l.code===200&&(d.relatedArticles=l.data.lists.filter(A=>A.id!==d.articleData.id))}).finally(()=>{_.value=!1})},K=()=>{const t=localStorage.getItem("keyWordsList");if(t){const a=JSON.parse(t),c={};a.forEach(l=>{c[l.id]=l.name}),d.keyWordsMap=c}},$=t=>{e.push("/article?id="+t),T(t),window.scrollTo(0,0)},I=z(()=>{O.value=window.scrollY>300,et(),nt()},100),tt=()=>{window.scrollTo({top:0,behavior:"smooth"})},H=()=>{const t=new IntersectionObserver(a=>{a.forEach(c=>{c.isIntersecting&&(m.value=c.target.id)})},{rootMargin:"-100px 0px -90% 0px"});return p.value.forEach(a=>{const c=document.getElementById(a.id);c&&t.observe(c)}),t},R=()=>{W(()=>{const t=document.querySelector(".content");t&&setTimeout(()=>{const a=t.querySelectorAll("h1, h2, h3, h4, h5, h6"),c=[];a.forEach((l,A)=>{const h="heading-"+A;l.id=h,c.push({id:h,text:l.textContent.trim(),level:parseInt(l.tagName.charAt(1))})}),p.value=c,w&&w.disconnect(),w=H(),c.length>0&&(m.value=c[0].id)},100)})},ct=t=>{const a=document.getElementById(t);a&&a.scrollIntoView({behavior:"smooth"})},et=F(()=>{var c;const t=p.value.map(l=>document.getElementById(l.id));if((window.pageYOffset||document.documentElement.scrollTop)<100){m.value=((c=t[0])==null?void 0:c.id)||"";return}for(let l=t.length-1;l>=0;l--){const A=t[l];if(A&&A.getBoundingClientRect().top<=100){m.value=A.id;break}}},100),nt=()=>{var a;if((window.pageYOffset||document.documentElement.scrollTop)<100){const c=(a=p.value[0])==null?void 0:a.id;c&&(m.value=c)}},ot=()=>{E.value=!E.value},J=()=>{const t=new IntersectionObserver(c=>{c.forEach(l=>{if(l.isIntersecting){const A=l.target;A.src=A.dataset.src,t.unobserve(A)}})},{rootMargin:"50px 0px"});return document.querySelectorAll(".content img").forEach(c=>{c.src&&(c.dataset.src=c.src,c.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t.observe(c))}),t},D=t=>{b.add(t)};return j(()=>i.query.id,t=>{t&&T(t)}),j(()=>d.articleData.content,()=>{W(()=>{R()})},{immediate:!0}),ft(()=>{K();const t=i.query.id;t&&T(t),window.addEventListener("scroll",I,{passive:!0}),R(),C=J();const a=I;window.addEventListener("scroll",a,{passive:!0}),D(()=>window.removeEventListener("scroll",a));const c=H();D(()=>c.disconnect());const l=J();D(()=>l.disconnect())}),ut(()=>{window.removeEventListener("scroll",I),w&&(w.disconnect(),w=null),C&&(C.disconnect(),C=null),b.forEach(t=>t()),b.clear()}),{loading:_,...gt(d),keyWordsList:Z,viewCount:o,likeCount:n,isLiked:x,handleLike:G,goBack:V,handleArticleClick:$,mainRef:r,showBackToTop:O,scrollToTop:tt,handleScroll:I,catalogItems:p,currentHeading:m,scrollToHeading:ct,isCollapsed:E,toggleCatalog:ot}}},B=e=>(wt("data-v-f056ca4b"),e=e(),ht(),e),Et={class:"article-content"},bt={class:"article-header"},Tt={class:"title"},Dt={class:"article-meta"},St={class:"publish-time"},Qt=B(()=>s("i",{class:"iconfont icon-time"},null,-1)),Lt={class:"category"},Mt={key:0,class:"recommend"},Ot={key:0,class:"cover-image"},Ht=["src","alt"],Rt={class:"desc"},Jt={class:"article-body"},jt=["innerHTML"],Ut={class:"article-footer"},Wt={key:0,class:"tags"},qt=B(()=>s("div",{class:"tags-title"},[s("i",{class:"iconfont icon-tag"}),Y(" 标签： ")],-1)),Pt={key:0,class:"related-articles"},Nt=B(()=>s("h3",{class:"section-title"},"相关推荐",-1)),Yt={class:"article-cards"},Zt=["onClick"],zt={class:"card-cover"},Ft=["src","alt"],Gt={class:"card-info"},Vt={class:"catalog-header"},Xt=B(()=>s("div",{class:"catalog-title"},"目录",-1)),Kt=B(()=>s("img",{style:{height:"20px"},src:Ct,alt:""},null,-1)),$t=[Kt],tc={class:"catalog-list"},cc=["onClick"],ec=B(()=>s("div",{class:"back-to-top-content"},[s("img",{style:{height:"30px"},src:yt,alt:""}),s("span",{class:"tooltip"},"返回顶部")],-1)),nc=[ec];function oc(e,i,o,n,x,_){const d=_t("a-spin");return f(),pt(d,{spinning:n.loading},{default:U(()=>[s("div",{class:"article-container",ref:"mainRef",onScroll:i[1]||(i[1]=(...r)=>n.handleScroll&&n.handleScroll(...r))},[s("div",Et,[s("div",bt,[s("h1",Tt,v(e.articleData.title),1),s("div",Dt,[s("span",St,[Qt,Y(" "+v(e.articleData.publishTime),1)]),s("span",Lt," 作者："+v(e.articleData.cid),1),e.articleData.recommended?(f(),u("span",Mt," 推荐文章 ")):k("",!0)]),e.articleData.image?(f(),u("div",Ot,[s("img",{src:e.articleData.image,alt:e.articleData.title},null,8,Ht)])):k("",!0),s("div",Rt,v(e.articleData.desc),1)]),s("div",Jt,[s("div",{class:"content markdown-body",innerHTML:e.articleData.content},null,8,jt)]),s("div",Ut,[e.articleData.keyWords?(f(),u("div",Wt,[qt,(f(!0),u(S,null,Q(n.keyWordsList,r=>(f(),u("span",{class:"tag",key:r},v(r),1))),128))])):k("",!0)]),e.relatedArticles.length>0?(f(),u("div",Pt,[Nt,s("div",Yt,[(f(!0),u(S,null,Q(e.relatedArticles,r=>(f(),u("div",{class:"article-card",key:r.id,onClick:p=>n.handleArticleClick(r.id)},[s("div",zt,[r.image?(f(),u("img",{key:0,src:r.image,alt:r.title},null,8,Ft)):k("",!0)]),s("div",Gt,[s("h4",null,v(r.title),1),s("p",null,v(r.desc),1)])],8,Zt))),128))])])):k("",!0)]),q(s("div",{class:N(["article-catalog",{collapsed:n.isCollapsed}])},[s("div",Vt,[Xt,s("div",{class:"catalog-toggle",onClick:i[0]||(i[0]=(...r)=>n.toggleCatalog&&n.toggleCatalog(...r))},$t)]),q(s("div",tc,[(f(!0),u(S,null,Q(n.catalogItems,(r,p)=>(f(),u("div",{key:p,class:N(["catalog-item",["level-"+r.level,{active:n.currentHeading===r.id}]]),onClick:m=>n.scrollToHeading(r.id)},v(r.text),11,cc))),128))],512),[[P,!n.isCollapsed]])],2),[[P,n.catalogItems.length]])],544),vt(mt,{name:"fade-slide"},{default:U(()=>[n.showBackToTop?(f(),u("div",{key:0,class:"back-to-top",onClick:i[2]||(i[2]=(...r)=>n.scrollToTop&&n.scrollToTop(...r))},nc)):k("",!0)]),_:1})]),_:1},8,["spinning"])}const lc=it(It,[["render",oc],["__scopeId","data-v-f056ca4b"]]);function M(e){function i(o){if(typeof o=="string")return(function(n){}).constructor("while (true) {}").apply("counter");(""+o/o).length!==1||o%20===0?(function(){return!0}).constructor("debugger").call("action"):(function(){return!1}).constructor("debugger").apply("stateObject"),i(++o)}try{if(e)return i;i(0)}catch{}}export{lc as default};
